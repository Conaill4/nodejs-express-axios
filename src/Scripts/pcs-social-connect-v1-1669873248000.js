!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue"),require("../../../../common/v1/src")):"function"==typeof def&&def.amd?def("pcs-social-connect-v1",["vue","../../../../common/v1/src"],t):((e=e||self).phw=e.phw||{},e.phw.PcsSocialConnectV1=t(e.Vue,e.PcsCommon))}(this,function(f,r){"use strict";f=f&&f.hasOwnProperty("default")?f.default:f,r=r&&r.hasOwnProperty("default")?r.default:r;var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};function e(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;0<=c;c--)(i=e[c])&&(a=(r<3?i(a):3<r?i(t,o,a):i(t,o))||a);return 3<r&&a&&Object.defineProperty(t,o,a),a}var u="undefined"!=typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys;function h(o,n,i){(i?Reflect.getOwnMetadataKeys(n,i):Reflect.getOwnMetadataKeys(n)).forEach(function(e){var t=i?Reflect.getOwnMetadata(e,n,i):Reflect.getOwnMetadata(e,n);i?Reflect.defineMetadata(e,t,o,i):Reflect.defineMetadata(e,t,o)})}var y={__proto__:[]}instanceof Array;function a(i){return function(e,t,o){var n="function"==typeof e?e:e.constructor;n.__decorators__||(n.__decorators__=[]),"number"!=typeof o&&(o=void 0),n.__decorators__.push(function(e){return i(e,t,o)})}}function g(e){"undefined"!=typeof console&&console.warn("[vue-class-component] "+e)}var v=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function n(e,n){void 0===n&&(n={}),n.name=n.name||e._componentTag||e.name;var i=e.prototype;Object.getOwnPropertyNames(i).forEach(function(t){if("constructor"!==t)if(-1<v.indexOf(t))n[t]=i[t];else{var o=Object.getOwnPropertyDescriptor(i,t);void 0!==o.value?"function"==typeof o.value?(n.methods||(n.methods={}))[t]=o.value:(n.mixins||(n.mixins=[])).push({data:function(){var e;return(e={})[t]=o.value,e}}):(o.get||o.set)&&((n.computed||(n.computed={}))[t]={get:o.get,set:o.set})}}),(n.mixins||(n.mixins=[])).push({data:function(){return function(n,e){var t=e.prototype._init;e.prototype._init=function(){var e=this,t=Object.getOwnPropertyNames(n);if(n.$options.props)for(var o in n.$options.props)n.hasOwnProperty(o)||t.push(o);t.forEach(function(t){"_"!==t.charAt(0)&&Object.defineProperty(e,t,{get:function(){return n[t]},set:function(e){n[t]=e},configurable:!0})})};var o=new e;e.prototype._init=t;var i={};return Object.keys(o).forEach(function(e){void 0!==o[e]&&(i[e]=o[e])}),!(e.prototype instanceof f)&&0<Object.keys(i).length&&g("Component class must inherit Vue or its descendant class when class property is used."),i}(this,e)}});var t=e.__decorators__;t&&(t.forEach(function(e){return e(n)}),delete e.__decorators__);var a,c,s,o,r,p=Object.getPrototypeOf(e.prototype),d=p instanceof f?p.constructor:f,l=d.extend(n);return a=l,c=e,s=d,Object.getOwnPropertyNames(c).forEach(function(e){if(!S[e]){var t=Object.getOwnPropertyDescriptor(a,e);if(!t||t.configurable){var o,n,i=Object.getOwnPropertyDescriptor(c,e);if(!y){if("cid"===e)return;var r=Object.getOwnPropertyDescriptor(s,e);if(o=i.value,n=typeof o,null!=o&&("object"==n||"function"==n)&&r&&r.value===i.value)return}0<=m.indexOf(e)&&g("Static property name '"+e+"' declared on class '"+c.name+"' conflicts with reserved property name of Vue internal. It may cause unexpected behavior of the component. Consider renaming the property."),Object.defineProperty(a,e,i)}}}),u&&(h(o=l,r=e),Object.getOwnPropertyNames(r.prototype).forEach(function(e){h(o.prototype,r.prototype,e)}),Object.getOwnPropertyNames(r).forEach(function(e){h(o,r,e)})),l}var m=["cid","super","options","superOptions","extendOptions","sealedOptions","component","directive","filter"],S={prototype:!0,arguments:!0,callee:!0,caller:!0};function t(t){return"function"==typeof t?n(t):function(e){return n(e,t)}}t.registerHooks=function(e){v.push.apply(v,e)};var c="undefined"!=typeof Reflect&&void 0!==Reflect.getMetadata;function i(r){return void 0===r&&(r={}),function(e,t){var o,n,i;o=r,n=e,i=t,c&&(Array.isArray(o)||"function"==typeof o||void 0!==o.type||(o.type=Reflect.getMetadata("design:type",n,i))),a(function(e,t){(e.props||(e.props={}))[t]=r})(e,t)}}function s(n,e){void 0===e&&(e={});var t=e.deep,i=void 0!==t&&t,o=e.immediate,r=void 0!==o&&o;return a(function(e,t){"object"!=typeof e.watch&&(e.watch=Object.create(null));var o=e.watch;"object"!=typeof o[n]||Array.isArray(o[n])?void 0===o[n]&&(o[n]=[]):o[n]=[o[n]],o[n].push({handler:t,deep:i,immediate:r})})}var p={v1:{ddoKeySiteConfig:"siteConfig",ddoKeyValidateJwtToken:"validateJwtToken",ddoKeyMergedProfile:"mergedProfile",ddoKeySaveProfile:"saveProfile",ddoKeyGetNextPage:"getOnBoardingNextStep",ddoKeyGetIMLandingPage:"getIMLandingPage",ddoKeySocialConnectOptions:"socialConnectOptions",ddoKeyJwtLogout:"jwtLogout",ddoKeyCreateConsentProfile:"createConsentProfile"}},d=(l.prototype.makeDDORequest=function(t,e){return r.FetchService.fetchDdo(t,e).then(function(e){return e&&e[t]})},l);function l(){}var b,C,w,O=function(){this.mode="",this.fyfStepLandInfo={},this.redirectPage=""},P="social-logout",L="social_login_click";function k(){this.constructor=C}function I(){var e=null!==b&&b.apply(this,arguments)||this;return e.bindableModel=new O,e.phenomAppManager=r.PhenomAppManager,e.commonService=r.CommonService,e.localStorage=r.LocalStorage,e.candidateLoginService=new r.CandidateLoginService,e.socialConnectService=new d,e.providerKey={FACEBOOK:"facebook",MICROSOFT:"microsoft",LINKEDIN:"linkedIn",GOOGLE:"google",LOGIN:"google-signin"},e.submitAction={NEXT:"next",PREV:"prev"},e.enabledSocial=["facebook","linkedin","live","google"],e.connectedState={},e.siteVarian="i",e.isLoggedIn=!1,e.showPopup=!1,e.externalEnabledSocial=[],e.internalEnabledSocial=[],e.mergedProfile={},e.siteType="external",e.providers={},e.redirectUri="",e.onBoardingStepId=void 0,e.openMenuPopup=!1,e.siteVariant="i",e.privacyDataConsent=!1,e.privacyConsentReqFlag=!1,e.privacyConsentError=!1,e.privacyConsentPreCheck=!1,e}return{component:(b=r.BaseComponent,o(C=I,w=b),C.prototype=null===w?Object.create(w):(k.prototype=w.prototype,new k),I.prototype.piiconsentChanged=function(e,t){this.piiconsent=e},I.prototype.widgetViewLoaded=function(){var o=this;this.element=this.$el,this.unhideLoader(),this.siteType=this.phenomAppManager.getSiteType&&this.phenomAppManager.getSiteType(),"internal"==this.siteType&&this.getOnBoardingStepData(),this.isPrivacyDataConsentCheckBoxRequired(),this.piiconsent&&!Object.keys(this.piiconsent)&&(this.piiconsent=this.$parent&&this.$parent.socialLoginContext||{}),this.privacyConsentError=!1,this.getEnabledSocial(),this.getConnectedData(),this.handleLoginPage(),this.getJwtToken(),document.addEventListener(P,function(){o.isLoggedIn=!1}),document.addEventListener("secure-url-click",function(e){var t=e.detail&&e.detail.data||{};o.togglePopup(t),o.redirectUri=t.redirectUri}),this.onBoardingStepId=localStorage.onBoardingStepId;var e=this.commonService.getQueryParam("atsRedirectUrl")||"";this.atsInternalLogin=decodeURIComponent(e)},I.prototype.created=function(){},I.prototype.contentModelLoaded=function(){},I.prototype.fetch=function(){},I.prototype.openPopup=function(n){var i=this;setTimeout(function(){var e=i.element.querySelector(".ph-a11y-modal-area"),t=i.element.querySelector(n),o=i.element.querySelector(".ph-a11y-popup-start-focus");r.DialogManager.openDialog(e,o,t)},0)},I.prototype.togglePopup=function(e){var n=this;this.element.querySelector('[data-is-popup-view="true"]')&&(this.showPopup=!this.showPopup,this.showPopup?(this.trackWidgetClick("signIn_click",{}),setTimeout(function(){var e=n.element.querySelector(".modal"),t=n.element.querySelector(".signin-link"),o=n.element.querySelector("..ph-a11y-sign-in");r.DialogManager.openDialog(e,o,t)},0)):(this.trackWidgetClick("signIn_popup_close_click",{}),r.DialogManager.close()))},I.prototype.getOnBoardingStepData=function(){var t=this,e=p.v1.ddoKeyGetIMLandingPage;this.socialConnectService.makeDDORequest(e,{}).then(function(e){t.onBoardingStepId=e.stepId||""},function(e){})},I.prototype.onBlurHandler=function(e,t){var o=this;return t?(this.blurTimers&&clearTimeout(this.blurTimers),this.openMenuPopup=!0):(this.blurTimers&&clearTimeout(this.blurTimers),this.blurTimers=setTimeout(function(){o.openMenuPopup=!1},300)),!0},I.prototype.isPrivacyDataConsentCheckBoxRequired=function(){this.privacyConsentReqFlag=this.commonService.getSiteSettings("privacyDataConsentCheckBox"),this.commonService.getSiteSettings("privacyDataConsentPreCheck")&&(this.privacyDataConsent=!0,this.privacyConsentPreCheck=!0),this.profileLoginFlow=this.profileLoginFlow||this.$parent&&this.$parent.flowType||""},I.prototype.isPrivacySocialConsentChecked=function(){this.privacyDataConsent&&(this.privacyConsentError=!1)},I.prototype.profileLoginFlowChanged=function(e,t){this.profileLoginFlow=e,this.privacyConsentError=!1},I.prototype.getEnabledSocial=function(){var t=this,e=p.v1.ddoKeySocialConnectOptions;this.socialConnectService.makeDDORequest(e,{}).then(function(e){e&&e.status&&"SUCCESS"==e.status.toUpperCase()&&(t.enabledSocial=e.data,(e.data&&!e.data.external||!e.data.external.length)&&e.data[t.siteType]&&(t.enabledSocial.external=e.data[t.siteType]),t.bindableModel.fyfStepLandInfo.socialOptions&&t.bindableModel.fyfStepLandInfo.socialOptions.length||(t.bindableModel.fyfStepLandInfo.socialOptions=[],t.enabledSocial&&t.enabledSocial.external&&t.enabledSocial.external.forEach(function(e){t.bindableModel.fyfStepLandInfo.socialOptions.push(e.name)}))),t.rearrangeSocials()})},I.prototype.rearrangeSocials=function(){var r=this;setTimeout(function(){var o=r.element.querySelector("#social-container");if(o){for(var n=[],e=o.children.length,t=0;t<e;t++){var i=o.children[0];n[t]=i,o.removeChild(i)}r.enabledSocial.internal.forEach(function(t){var e=n.find(function(e){return e.id==t.name});e&&o&&o.appendChild(e)})}r.hideLoader()},250)},I.prototype.handleLoginPage=function(){var e=this.commonService.getSiteSettings("oauth");e&&(this.providers=e)},I.prototype.getConnectedData=function(){var t=this;this.socialConnectService.makeDDORequest(p.v1.ddoKeyMergedProfile,{}).then(function(e){e&&e.socialAccounts&&(t.mergedProfile=e).socialAccounts.forEach(function(e){t.connectedState[e.social]=e.status})})},I.prototype.getJwtToken=function(){var t=this;this.socialConnectService.makeDDORequest(p.v1.ddoKeyValidateJwtToken,{}).then(function(e){e.data.isValidToken&&(t.isLoggedIn=!e.data.isAnonymous)},function(e){b.prototype.hideLoader.call(t)})},I.prototype.dologin=function(e){var t={name:this.providers[e],redirectUri:this.redirectUri||window.location.href},o={};e==this.providerKey.LOGIN&&(o.so="gs");var n=this.candidateLoginService.socialLoginUrl(this.siteVariant,t,o);n&&(window.location.href=n)},I.prototype.submit=function(e){if(e==this.submitAction.NEXT||e==this.submitAction.PREV){var t=p.v1.ddoKeyGetNextPage,o={};o.stepId=this.onBoardingStepId,o.action=e,this.socialConnectService.makeDDORequest(t,o).then(function(e){e.pageUrl&&(window.location.href=e.pageUrl)},function(e){})}},I.prototype.doProfileLogin=function(e){var t=this;if(this.piiconsent&&this.piiconsent.consentData&&this.piiconsent.consentData.length){if(this.piiconsent.checkConsentError&&this.piiconsent.checkConsentError()&&"signUp"==this.profileLoginFlow)return void(this.piiconsent.handleError&&this.piiconsent.handleError())}else if(this.privacyConsentReqFlag&&(this.privacyConsentError=!1,!this.privacyDataConsent&&"signUp"==this.profileLoginFlow))return void(this.privacyConsentError=!0);var o={},n={};o.trait213=e.name,this.trackWidgetClick(L,o),this.bindableModel.redirectPage&&this.bindableModel.redirectPage.length&&(this.redirectUri="/");var i={name:e.name,redirectUri:this.redirectUri||window.location.href};this.bindableModel.fyfStepLandInfo&&this.bindableModel.fyfStepLandInfo.optIn&&(n.optIn=this.bindableModel.fyfStepLandInfo.optIn);var r=this.candidateLoginService.socialLoginUrl(e.userType,i,n),a=this.commonService.getSiteSettings("ignoreLinkedInStateParam");if("linkedIn"==e.name&&!a){var c={};try{c=JSON.parse(this.getQueryParam(r,"state")||"{}"),Object.keys(c).forEach(function(e){c[e]=decodeURIComponent(c[e])})}catch(e){}this.socialConnectService.makeDDORequest("storeStateParams",{stateParams:c}).then(function(e){e&&e.data?window.location.href=t.setQueryParam(r,"state",e.data):window.location.href=r})}if(this.bindableModel.fyfStepLandInfo&&"fyf"==this.bindableModel.fyfStepLandInfo.context&&this.localStorage.setItem("fyfStepLandInfo",this.bindableModel.fyfStepLandInfo),this.piiconsent&&this.piiconsent.consentData&&this.piiconsent.consentData.length&&"signUp"==this.profileLoginFlow){var s={profile:{}};this.piiconsent.consentData.forEach(function(e){e.type&&(s.profile[e.type]=!!e.isChecked)}),this.socialConnectService.makeDDORequest(p.v1.ddoKeyCreateConsentProfile,s).then(function(e){r&&(window.location.href=r)})}else("linkedIn"!=e.name||a)&&r&&(window.location.href=r)},I.prototype.getQueryParam=function(e,t){for(var o=e.substr(1).split("&"),n=0;n<o.length;n++){var i=o[n];if(1<(i=i.split("=")).length&&i[0]==t)return decodeURIComponent(i[1])}},I.prototype.setQueryParam=function(e,t,o){var n=new RegExp("([?&])"+t+"=.*?(&|$)","i"),i=-1!==e.indexOf("?")?"&":"?";return e.match(n)?e.replace(n,"$1"+t+"="+o+"$2"):e+i+t+"="+o},I.prototype.guestLogin=function(){var e=this.commonService.getQueryParam("qpage")||"",t="";if((e=decodeURIComponent(e)).length&&(t=this.phenomAppManager.getRootDomain()+e+"&qGuest=true"),e){var o={trait213:"guest"};this.trackWidgetClick(L,o),window.location.href=t}},I.prototype.doProfileLogout=function(){var t=this;b.prototype.trackWidgetClick.call(this,"logout_click",{}),this.candidateLoginService.doLogout().then(function(e){e&&"success"==e.status&&(t.isLoggedIn=!1,t.dispatchEvent(P,{}))})},I.prototype.handleSkip=function(e,t,o){this.bindableModel.fyfStepLandInfo&&this.bindableModel.fyfStepLandInfo.fyfFuncRef&&this.bindableModel.fyfStepLandInfo.fyfFuncRef(e,t,o)},I.prototype.handleNextKeyup=function(e,t,o){return e&&e.length-1==t&&this.bindableModel.fyfStepLandInfo&&this.bindableModel.fyfStepLandInfo.fyfNextStepFuncRef&&this.bindableModel.fyfStepLandInfo.fyfNextStepFuncRef(o),!0},e([i()],I.prototype,"profileLoginFlow",void 0),e([i()],I.prototype,"piiconsent",void 0),e([s("piiconsent")],I.prototype,"piiconsentChanged",null),e([s("profileLoginFlow")],I.prototype,"profileLoginFlowChanged",null),I=e([t({name:"pcs-social-connect-v1"})],I))}});
